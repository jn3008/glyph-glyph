import{a as q,t as M,d as ge,h as Me,c as Ve}from"../chunks/disclose-version.B8nYLgL4.js";import{i as N}from"../chunks/legacy.CgpFKzs7.js";import{aM as je,h as He,u as Le,b as Pe,a4 as Be,z as De,p as O,a9 as I,aa as _e,c as y,r as g,s as V,A as e,t as A,a as Q,aw as f,a7 as F,y as r,M as $,au as ue,ay as Re,ax as Ge,aN as Ke,f as be,aO as Ne}from"../chunks/utils.BlbffUCT.js";import{l as Oe,s as J,e as B}from"../chunks/render.C1RE0XEP.js";import{i as K,s as ye,a as X}from"../chunks/store.CbB5JJSv.js";import{j as ee,l as H,n as Qe,k as ve,w as We,x as Ue,y as Xe,z as Fe,v as he,A as Je,B as Ye,d as Ze}from"../chunks/dictionary.BY6BbDGO.js";import{b as te}from"../chunks/this.-2yZ0d7J.js";import{p as z}from"../chunks/props.BQz8PEny.js";import{o as fe}from"../chunks/index-client.DXjkudc0.js";import{a as we,b as de,q as U,u as $e,h as et}from"../chunks/scores.p8Rtmzwn.js";import{s as ke,c as tt}from"../chunks/settings.C1rRRxrU.js";function at(a,t,s=t){var o=je();Oe(a,"input",l=>{var i=l?a.defaultValue:a.value;if(i=le(a)?oe(i):i,s(i),o&&i!==(i=t())){var p=a.selectionStart,n=a.selectionEnd;a.value=i??"",n!==null&&(a.selectionStart=p,a.selectionEnd=Math.min(n,a.value.length))}}),(He&&a.defaultValue!==a.value||Le(t)==null&&a.value)&&s(le(a)?oe(a.value):a.value),Pe(()=>{var l=t();le(a)&&l===oe(a.value)||a.type==="date"&&!l&&!a.value||l!==a.value&&(a.value=l??"")})}function le(a){var t=a.type;return t==="number"||t==="range"}function oe(a){return a===""?null:+a}function ce(a,t,s){var o=De(a,t);o&&o.set&&(a[t]=s,Be(()=>{a[t]=null}))}function st(a){return function(...t){var s=t[0];return s.preventDefault(),a==null?void 0:a.apply(this,t)}}var nt=M("<div> </div>"),it=M('<div class="quiz-item-wrapper svelte-2386oy"><div class="quiz-item svelte-2386oy"><div class="glyph svelte-2386oy"> </div> <!></div></div>');function rt(a,t){O(t,!1);const s=f(),o=f(),l=f();let i=z(t,"glyph",8),p=z(t,"answered",8,void 0),n=z(t,"is_correct_answer",8,void 0),b=z(t,"is_current",8,!1),k=z(t,"element",12,void 0);I(()=>F(p()),()=>{r(s,p()!==void 0)}),I(()=>(e(s),F(n())),()=>{r(o,e(s)?n():!1)}),I(()=>(e(s),F(n())),()=>{r(l,e(s)?!n():!1)}),_e(),N();var d=it(),u=y(d),v=y(u),_=y(v,!0);g(v);var m=V(v,2);{var h=w=>{var E=nt();const S=$(()=>`romanisation ${(we(i())[0].length>3?"long":"")??""} svelte-2386oy`);var x=y(E,!0);A(()=>J(x,we(i())[0])),g(E),A(()=>ee(E,e(S))),q(w,E)};K(m,w=>{e(l)&&w(h)})}g(u),te(u,w=>k(w),()=>k()),g(d),A(()=>{H(u,"has-answer",e(s)),H(u,"is-correct",e(o)),H(u,"is-incorrect",e(l)),H(u,"is-current",b()),J(_,i())}),q(a,d),Q()}var lt=M("<div><!></div>"),ot=M('<section class="quiz-container svelte-vgkonl"><div></div></section>');function ct(a,t){O(t,!1);let s=z(t,"items",8),o=z(t,"current_idx",8),l=f(0),i=f(),p=f(!0);async function n(){var _,m;if(await ue(),!e(i))return;const v=e(i).querySelectorAll(".quiz-content > .quiz-glyph");r(l,0);for(let h=0;h<o();h++)r(l,e(l)+(((_=v[h])==null?void 0:_.getBoundingClientRect().width)||0));r(l,e(l)+(((m=v[o()])==null?void 0:m.offsetWidth)||0)/2)}async function b(){r(p,!0),await ue(),setTimeout(()=>{r(p,!1)},2)}fe(()=>{n(),b()});function k(v){let m=Math.abs(v-o());return m=We(Ue(Xe(m,0,8,0,1)),2)*10,m}window.addEventListener("resize",()=>{b()}),I(()=>(F(s()),F(o())),()=>{(s()||o())&&n()}),_e(),N();var d=ot(),u=y(d);Qe(u,7,s,({id:v,glyph:_,answered:m,is_correct_answer:h})=>v,(v,_,m)=>{let h=()=>e(_).glyph,w=()=>e(_).answered,E=()=>e(_).is_correct_answer;var S=lt();const x=$(()=>`filter: blur(calc(${k(e(m))??""}px))`);var T=y(S),j=$(()=>e(m)==o());rt(T,{get glyph(){return h()},get answered(){return w()},get is_correct_answer(){return E()},get is_current(){return e(j)}}),g(S),A(()=>{ee(S,`quiz-glyph ${(e(m)===o()?"current":"")??""} svelte-vgkonl`),ve(S,"style",e(x))}),q(v,S)}),g(u),g(d),te(d,v=>r(i,v),()=>e(i)),A(()=>{ee(u,`quiz-content ${(e(p)?"no-transition":"")??""} svelte-vgkonl`),ve(u,"style",`transform: translateX(calc(50vw - ${e(l)??""}px));`)}),q(a,d),Q()}var ut=M('<form class="answer-input content-width svelte-i9oslv"><input type="text" class="text-field svelte-i9oslv" placeholder="type here..." autocapitalize="none" autocomplete="off" autocorrect="off"></form>');function vt(a,t){O(t,!1);const s=ye(),o=()=>X(ke,"$settings",s);let l=z(t,"onSubmit",8),i=z(t,"input",12,""),p=z(t,"current_glyph",8),n=z(t,"input_element",12);const b=/^\s+$/;let k=f(!1);function d(){de(i(),p())||r(k,!0),l()(i()),i("")}function u(h){const w=["insertCompositionText","deleteCompositionText"];return h.isComposing||w.includes(h.inputType)}function v(h){const w=h;if(!u(w)&&p()!==null&&w.data!==null){if(i(i().trim()),b.test(w.data)){d();return}de(i(),p())&&o().auto_submit&&d()}}N();var _=ut(),m=y(_);Fe(m),ve(m,"spellcheck",!1),te(m,h=>n(h),()=>n()),g(_),A(()=>H(_,"shake-animation-playing",e(k))),at(m,i),B("input",m,v),B("submit",_,st(d)),B("animationend",_,()=>r(k,!1)),q(a,_),Q()}var dt=M('<section class="menu svelte-1ktif42"><div class="button-container svelte-1ktif42"><a href="setup" class="button svelte-1ktif42" title="Go back"><span class="material-symbols-rounded menu-icon svelte-1ktif42">arrow_back</span></a></div> <div class="button-container svelte-1ktif42"><button type="button" class="button svelte-1ktif42" title="Toggle auto-submit"><span class="material-symbols-rounded reset-animation-container menu-icon svelte-1ktif42">keyboard_double_arrow_up</span></button></div> <div class="button-container svelte-1ktif42"><button type="button" class="button tilt svelte-1ktif42" title="Restart game"><span class="tilt-animation-container svelte-1ktif42"><span class="material-symbols-rounded reset-animation-container menu-icon flipped svelte-1ktif42">refresh</span></span></button></div></section>');function _t(a,t){O(t,!1);let s=f(!1),o=z(t,"menu_event",8),l=z(t,"is_keyboard_open",8),i=z(t,"auto_submit",8);N();var p=dt(),n=V(y(p),2),b=y(n);g(n);var k=V(n,2),d=y(k),u=y(d),v=y(u);g(u),g(d),g(k),g(p),A(()=>{H(p,"keyboard-open",l()),H(n,"activated",i()),H(d,"reset-animation-playing",e(s))}),B("click",b,()=>{o()("toggle-auto-submit")}),B("animationend",v,()=>{r(s,!1)}),B("click",d,()=>{o()("restart"),r(s,!0)}),q(a,p),Q()}var ft=M('<span class="best-time not-set svelte-13j0w94">best: --:--.-s</span>'),mt=M('<span class="best-time svelte-13j0w94">best: <span class="nowrap svelte-13j0w94"> </span></span>'),pt=M('<div class="stopwatch svelte-13j0w94"><span><!>s</span> <!></div>');function gt(a,t){O(t,!1);let s=z(t,"elapsed_time",12,0),o=z(t,"is_paused",12,!0),l=z(t,"is_disabled",8,!1),i=z(t,"best_time",24,()=>-1),p=z(t,"time_style",8,"normal"),n=null;fe(()=>()=>{k()});function b(){o(!1),n||(n=setInterval(()=>{s(s()+.1),s(Je(s(),2))},100))}function k(){o(!0),n&&(clearInterval(n),n=null)}function d(){k(),s(0)}N();var u=pt(),v=y(u),_=y(v);{var m=x=>{var T=ge("--:--.-");q(x,T)},h=x=>{var T=ge();A(()=>J(T,he(s()))),q(x,T)};K(_,x=>{l()?x(m):x(h,!1)})}Re(),g(v);var w=V(v,2);{var E=x=>{var T=ft();q(x,T)},S=x=>{var T=mt(),j=V(y(T)),L=y(j);A(()=>J(L,`${he(i())??""}s`)),g(j),g(T),q(x,T)};K(w,x=>{i()<0?x(E):x(S,!1)})}return g(u),A(()=>ee(v,`time ${p()??""} nowrap svelte-13j0w94`)),q(a,u),ce(t,"startTimer",b),ce(t,"stopTimer",k),ce(t,"resetTimer",d),Q({startTimer:b,stopTimer:k,resetTimer:d})}var bt=M("<!> <!> <!>",1),ht=M('<div><div class="contents svelte-ebb7wt"><div class="top-bar svelte-ebb7wt"><div><a href="/">glyph-glyph</a> <span class="config-id svelte-ebb7wt"> </span></div> <!></div> <div class="play-contents svelte-ebb7wt"><!></div></div></div>');function At(a,t){O(t,!1);const s=ye(),o=()=>X(U,"$quiz",s),l=()=>X(Ze,"$game_config",s),i=()=>X(et,"$high_scores",s),p=()=>X(ke,"$settings",s),n=f(),b=f(),k=f(),d=f(),u=f(),v=f(),_=f(),m=f();let h=f(!0),w=f(!1),E=f(!1);function S(){window.visualViewport&&r(E,window.visualViewport.height<window.innerHeight)}fe(()=>{window.visualViewport&&(window.visualViewport.addEventListener("resize",S),S());const c=U.subscribe(()=>{r(h,!1)});return r(w,e(b)>0),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",S),c()}});const x=/^[a-z0-9]+$/i;let T=f(),j=f(),L=f(),ae=f(0),D=f(),Y=f(!1);function xe(c){var C;switch(c){case"restart":l().path.includes("hangul")&&l().path.includes("syllables")&&Ye(),U.reset(),e(_)&&((C=e(L))==null||C.resetTimer(),r(w,!1),r(Y,!1));break;case"toggle-auto-submit":tt()}}async function ze(c){if(!l().is_valid||!e(k))return;e(_)&&e(D)&&e(L).startTimer();const C=de(c,e(k).glyph);!C&&c===""||(U.updateItem(e(b),R=>({...R,answered:c,is_correct_answer:C})),U.updateIndex(Ne(b)),!e(w)&&e(b)==e(n).length&&e(_)&&!e(D)&&(e(L).stopTimer(),e(d)&&r(Y,$e(e(u),e(ae)))),await ue())}function Te(c){c.isComposing||document.activeElement!==e(j)&&c.key!==" "&&c.key.length===1&&x.test(c.key)&&e(j).focus()}I(()=>o(),()=>{r(n,o().items)}),I(()=>o(),()=>{r(b,o().current_idx)}),I(()=>(e(n),e(b)),()=>{r(k,e(n)&&e(n)[e(b)])}),I(()=>(e(n),e(b)),()=>{r(d,e(n).slice(0,e(b)).every(c=>c==null?void 0:c.is_correct_answer))}),I(()=>l(),()=>{r(u,l().id)}),I(()=>(i(),e(u)),()=>{r(v,i()[e(u)])}),I(()=>p(),()=>{r(_,p().using_stopwatch)}),I(()=>(e(w),e(Y),e(d),e(D)),()=>{r(m,e(w)?"inactive":e(Y)?"record-set":e(d)?e(D)?"inactive":"normal":"incorrect")}),_e(),N();var se=ht();Me(c=>{Ge.title="Play Â· glyph-glyph"}),B("keydown",Ke,Te);var me=y(se),ne=y(me),ie=y(ne),pe=V(y(ie),2),qe=y(pe,!0);g(pe),g(ie);var Se=V(ie,2);{var Ee=c=>{var C=Ve(),R=be(C);{var Z=W=>{te(gt(W,{get is_disabled(){return e(w)},get best_time(){return e(v)},get time_style(){return e(m)},get elapsed_time(){return e(ae)},set elapsed_time(P){r(ae,P)},get is_paused(){return e(D)},set is_paused(P){r(D,P)},$$legacy:!0}),P=>r(L,P),()=>e(L))};K(R,W=>{e(_)&&W(Z)})}q(c,C)};K(Se,c=>{e(h)||c(Ee)})}g(ne);var re=V(ne,2),Ie=y(re);{var Ce=c=>{},Ae=c=>{var C=bt(),R=be(C);ct(R,{get items(){return e(n)},get current_idx(){return e(b)}});var Z=V(R,2),W=$(()=>{var G;return(G=e(k))==null?void 0:G.glyph});vt(Z,{onSubmit:ze,get current_glyph(){return e(W)},get input(){return e(T)},set input(G){r(T,G)},get input_element(){return e(j)},set input_element(G){r(j,G)},$$legacy:!0});var P=V(Z,2);_t(P,{menu_event:xe,get is_keyboard_open(){return e(E)},get auto_submit(){return p().auto_submit}}),q(c,C)};K(Ie,c=>{e(h)?c(Ce):c(Ae,!1)})}g(re),g(me),g(se),A(()=>{J(qe,l().id),H(re,"keyboard-open",e(E))}),q(a,se),Q()}export{At as component};
