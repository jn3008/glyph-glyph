import{a as T,t as M,b as fe,h as Ie,c as Se}from"../chunks/disclose-version.BnyP3OB8.js";import{i as V}from"../chunks/legacy.Vqdj_PMR.js";import{aM as Ce,h as Ee,u as Me,b as Ae,a7 as Be,C as De,p as W,ac as S,ad as ue,c as w,r as p,s as B,D as e,t as E,a as j,aB as f,aa as U,B as l,Q as Z,az as le,ae as Pe,af as He,aN as Qe,f as me,aO as Re}from"../chunks/utils.Dhw7Y63s.js";import{l as Le,s as X,e as N}from"../chunks/render.DlAr8I1h.js";import{i as O,s as Ne,a as Y}from"../chunks/store.BWdm8UL4.js";import{b as ee}from"../chunks/this.CHCpDkWg.js";import{b as ge,e as Oe,j as Ve,k as We,m as je,l as oe,f as pe,r as Ge,q as K,n as Ke,g as Ue,h as Xe}from"../chunks/scores.CM1Rnh9o.js";import{s as $,t as L,a as ce,r as Fe}from"../chunks/class.7PBngDXZ.js";import{p as x}from"../chunks/props.edKkFTeU.js";import{o as ve}from"../chunks/index-client.BhUYpw5D.js";import{s as Je}from"../chunks/settings._mfimNkJ.js";function Ye(t,a,s=a){var r=Ce();Le(t,"input",n=>{var o=n?t.defaultValue:t.value;if(o=re(t)?ne(o):o,s(o),r&&o!==(o=a())){var h=t.selectionStart,i=t.selectionEnd;t.value=o??"",i!==null&&(t.selectionStart=h,t.selectionEnd=Math.min(i,t.value.length))}}),(Ee&&t.defaultValue!==t.value||Me(a)==null&&t.value)&&s(re(t)?ne(t.value):t.value),Ae(()=>{var n=a();re(t)&&n===ne(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function re(t){var a=t.type;return a==="number"||a==="range"}function ne(t){return t===""?null:+t}function ie(t,a,s){var r=De(t,a);r&&r.set&&(t[a]=s,Be(()=>{t[a]=null}))}function Ze(t){return function(...a){var s=a[0];return s.preventDefault(),t==null?void 0:t.apply(this,a)}}var $e=M("<div> </div>"),et=M('<div class="quiz-item-wrapper svelte-1izkrrf"><div class="quiz-item svelte-1izkrrf"><div class="glyph svelte-1izkrrf"> </div> <!></div></div>');function tt(t,a){W(a,!1);const s=f(),r=f(),n=f();let o=x(a,"glyph",8),h=x(a,"answered",8,void 0),i=x(a,"is_correct_answer",8,void 0),m=x(a,"is_current",8,!1),k=x(a,"element",12,void 0);S(()=>U(h()),()=>{l(s,h()!==void 0)}),S(()=>(e(s),U(i())),()=>{l(r,e(s)?i():!1)}),S(()=>(e(s),U(i())),()=>{l(n,e(s)?!i():!1)}),ue(),V();var y=et(),c=w(y),u=w(c),_=w(u,!0);p(u);var d=B(u,2);{var z=q=>{var A=$e();const I=Z(()=>`romanisation ${(ge(o())[0].length>3?"long":"")??""} svelte-1izkrrf`);var g=w(A,!0);E(()=>X(g,ge(o())[0])),p(A),E(()=>$(A,e(I))),T(q,A)};O(d,q=>{e(n)&&q(z)})}p(c),ee(c,q=>k(q),()=>k()),p(y),E(()=>{L(c,"has-answer",e(s)),L(c,"is-correct",e(r)),L(c,"is-incorrect",e(n)),L(c,"is-current",m()),X(_,o())}),T(t,y),j()}var at=M("<div><!></div>"),st=M('<section class="quiz-container svelte-guhsqx"><div></div></section>');function rt(t,a){W(a,!1);let s=x(a,"items",8),r=x(a,"current_idx",8),n=f(0),o=f(),h=f(!0);async function i(){var _,d;if(await le(),!e(o))return;const u=e(o).querySelectorAll(".quiz-content > .quiz-glyph");l(n,0);for(let z=0;z<r();z++)l(n,e(n)+(((_=u[z])==null?void 0:_.getBoundingClientRect().width)||0));l(n,e(n)+(((d=u[r()])==null?void 0:d.offsetWidth)||0)/2)}async function m(){l(h,!0),await le(),setTimeout(()=>{l(h,!1)},2)}ve(()=>{i(),m()});function k(u){let d=Math.abs(u-r());return d=Ve(We(je(d,0,8,0,1)),2)*10,d}window.addEventListener("resize",()=>{m()}),S(()=>(U(s()),U(r())),()=>{(s()||r())&&i()}),ue(),V();var y=st(),c=w(y);Oe(c,7,s,({id:u,glyph:_,answered:d,is_correct_answer:z})=>u,(u,_,d)=>{let z=()=>e(_).glyph,q=()=>e(_).answered,A=()=>e(_).is_correct_answer;var I=at();const g=Z(()=>`filter: blur(calc(${k(e(d))??""}px))`);var b=w(I),D=Z(()=>e(d)==r());tt(b,{get glyph(){return z()},get answered(){return q()},get is_correct_answer(){return A()},get is_current(){return e(D)}}),p(I),E(()=>{$(I,`quiz-glyph ${(e(d)===r()?"current":"")??""} svelte-guhsqx`),ce(I,"style",e(g))}),T(u,I)}),p(c),p(y),ee(y,u=>l(o,u),()=>e(o)),E(()=>{$(c,`quiz-content ${(e(h)?"no-transition":"")??""} svelte-guhsqx`),ce(c,"style",`transform: translateX(calc(50vw - ${e(n)??""}px));`)}),T(t,y),j()}var nt=M('<form class="answer-input content-width svelte-i9oslv"><input type="text" class="text-field svelte-i9oslv" placeholder="type here..." autocapitalize="none" autocomplete="off" autocorrect="off"></form>');function it(t,a){W(a,!1);let s=x(a,"onSubmit",8),r=x(a,"input",12,""),n=x(a,"current_glyph",8),o=x(a,"input_element",12);const h=/^\s+$/;let i=f(!1);function m(){oe(r(),n())||l(i,!0),s()(r()),r("")}function k(_){const d=["insertCompositionText","deleteCompositionText"];return _.isComposing||d.includes(_.inputType)}function y(_){const d=_;if(!k(d)&&n()!==null&&d.data!==null){if(r(r().trim()),h.test(d.data)){m();return}oe(r(),n())&&m()}}V();var c=nt(),u=w(c);Fe(u),ce(u,"spellcheck",!1),ee(u,_=>o(_),()=>o()),p(c),E(()=>L(c,"shake-animation-playing",e(i))),Ye(u,r),N("input",u,y),N("submit",c,Ze(m)),N("animationend",c,()=>l(i,!1)),T(t,c),j()}var lt=M('<section class="menu svelte-14t9kaw"><a href="setup" class="button svelte-14t9kaw" title="Go back"><span class="material-symbols-rounded menu-icon svelte-14t9kaw">arrow_back</span></a> <button type="button" class="button tilt svelte-14t9kaw" title="Restart game"><span class="tilt-animation-container svelte-14t9kaw"><span class="material-symbols-rounded reset-animation-container menu-icon svelte-14t9kaw">refresh</span></span></button></section>');function ot(t,a){W(a,!1);let s=f(!1),r=x(a,"menu_event",8);V();var n=lt(),o=B(w(n),2),h=w(o),i=w(h);p(h),p(o),p(n),E(()=>L(o,"reset-animation-playing",e(s))),N("animationend",i,()=>{l(s,!1)}),N("click",o,()=>{r()("restart"),l(s,!0)}),T(t,n),j()}var ct=M('<span class="best-time not-set svelte-1o3ys2">best: --:--.-s</span>'),ut=M('<span class="best-time svelte-1o3ys2"> </span>'),vt=M('<div class="stopwatch svelte-1o3ys2"><span><!>s</span> <!></div>');function _t(t,a){W(a,!1);let s=x(a,"elapsed_time",12,0),r=x(a,"is_paused",12,!0),n=x(a,"is_disabled",8,!1),o=x(a,"best_time",24,()=>-1),h=x(a,"time_style",8,"normal"),i=null;ve(()=>()=>{k()});function m(){r(!1),i||(i=setInterval(()=>{s(s()+.1),s(Ge(s(),2))},100))}function k(){r(!0),i&&(clearInterval(i),i=null)}function y(){k(),s(0)}V();var c=vt(),u=w(c),_=w(u);{var d=g=>{var b=fe("--:--.-");T(g,b)},z=g=>{var b=fe();E(()=>X(b,pe(s()))),T(g,b)};O(_,g=>{n()?g(d):g(z,!1)})}Pe(),p(u);var q=B(u,2);{var A=g=>{var b=ct();T(g,b)},I=g=>{var b=ut(),D=w(b);E(()=>X(D,`best: ${pe(o())??""}s`)),p(b),T(g,b)};O(q,g=>{o()<0?g(A):g(I,!1)})}return p(c),E(()=>$(u,`time ${h()??""} svelte-1o3ys2`)),T(t,c),ie(a,"startTimer",m),ie(a,"stopTimer",k),ie(a,"resetTimer",y),j({startTimer:m,stopTimer:k,resetTimer:y})}var dt=M("<!> <!> <!>",1),ft=M('<div><div class="top-bar svelte-1ccyeq1"><div class="title-config-container svelte-1ccyeq1"><a href="/" class="title svelte-1ccyeq1">glyph-glyph</a> <span class="config-id svelte-1ccyeq1"> </span></div> <!></div> <div class="contents svelte-1ccyeq1"><!></div></div>');function Tt(t,a){W(a,!1);const s=Ne(),r=()=>Y(K,"$quiz",s),n=()=>Y(Ue,"$game_config",s),o=()=>Y(Xe,"$high_scores",s),h=()=>Y(Je,"$settings",s),i=f(),m=f(),k=f(),y=f(),c=f(),u=f(),_=f(),d=f();let z=f(!0),q=f(!1);ve(()=>{const v=K.subscribe(()=>{l(z,!1)});return l(q,e(m)>0),()=>v()});const A=/^[a-z0-9]+$/i;let I=f(),g=f(),b=f(),D=f(0),H=f(),F=f(!1);function he(v){var C;switch(v){case"restart":K.reset(),e(_)&&((C=e(b))==null||C.resetTimer(),l(q,!1),l(F,!1));break}}async function ye(v){if(!n().is_valid||!e(k))return;e(_)&&e(H)&&e(b).startTimer();const C=oe(v,e(k).glyph);!C&&v===""||(K.updateItem(e(m),Q=>({...Q,answered:v,is_correct_answer:C})),K.updateIndex(Re(m)),!e(q)&&e(m)==e(i).length&&e(_)&&!e(H)&&(e(b).stopTimer(),e(y)&&l(F,Ke(e(c),e(D)))),await le())}function be(v){v.isComposing||document.activeElement!==e(g)&&v.key!==" "&&v.key.length===1&&A.test(v.key)&&e(g).focus()}S(()=>r(),()=>{l(i,r().items)}),S(()=>r(),()=>{l(m,r().current_idx)}),S(()=>(e(i),e(m)),()=>{l(k,e(i)&&e(i)[e(m)])}),S(()=>(e(i),e(m)),()=>{l(y,e(i).slice(0,e(m)).every(v=>v==null?void 0:v.is_correct_answer))}),S(()=>n(),()=>{l(c,n().id)}),S(()=>(o(),e(c)),()=>{l(u,o()[e(c)])}),S(()=>h(),()=>{l(_,h().using_stopwatch)}),S(()=>(e(q),e(F),e(y),e(H)),()=>{l(d,e(q)?"inactive":e(F)?"record-set":e(y)?e(H)?"inactive":"normal":"incorrect")}),ue(),V();var te=ft();Ie(v=>{He.title="Play Â· glyph-glyph"}),N("keydown",Qe,be);var ae=w(te),se=w(ae),_e=B(w(se),2),we=w(_e,!0);p(_e),p(se);var xe=B(se,2);{var ke=v=>{var C=Se(),Q=me(C);{var J=G=>{ee(_t(G,{get is_disabled(){return e(q)},get best_time(){return e(u)},get time_style(){return e(d)},get elapsed_time(){return e(D)},set elapsed_time(P){l(D,P)},get is_paused(){return e(H)},set is_paused(P){l(H,P)},$$legacy:!0}),P=>l(b,P),()=>e(b))};O(Q,G=>{e(_)&&G(J)})}T(v,C)};O(xe,v=>{e(z)||v(ke)})}p(ae);var de=B(ae,2),qe=w(de);{var ze=v=>{},Te=v=>{var C=dt(),Q=me(C);rt(Q,{get items(){return e(i)},get current_idx(){return e(m)}});var J=B(Q,2),G=Z(()=>{var R;return(R=e(k))==null?void 0:R.glyph});it(J,{onSubmit:ye,get current_glyph(){return e(G)},get input(){return e(I)},set input(R){l(I,R)},get input_element(){return e(g)},set input_element(R){l(g,R)},$$legacy:!0});var P=B(J,2);ot(P,{menu_event:he}),T(v,C)};O(qe,v=>{e(z)?v(ze):v(Te,!1)})}p(de),p(te),E(()=>X(we,n().id)),T(t,te),j()}export{Tt as component};
