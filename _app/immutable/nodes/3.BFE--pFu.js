import{a as E,t as I,d as be,h as Be,c as De}from"../chunks/disclose-version.DMb1MWqK.js";import{i as F}from"../chunks/legacy.CAdgRAij.js";import{aM as Le,T as $e,u as Ne,b as Re,a4 as Fe,x as Ge,p as G,a9 as S,aa as he,c as b,r as w,s as A,y as e,t as V,a as K,ay as d,w as n,a7 as U,N as ae,au as ne,ax as Ke,az as Oe,aN as Qe,f as ke,aO as We}from"../chunks/utils.CzggQQeO.js";import{l as Ue,s as J,e as N}from"../chunks/render.CfWNEYHW.js";import{i as R,s as ze,a as $}from"../chunks/store.OBsKuDGv.js";import{s as re,o as H,m as Xe,a as pe,z as Je,A as Ye,C as Ze,D as et,B as xe,y as Te,E as tt,F as st,f as at,i as nt}from"../chunks/dictionary.D-f1v8xe.js";import{b as ie}from"../chunks/this.BB9oy7Yh.js";import{p as T}from"../chunks/props.BU03OgPP.js";import{o as ye}from"../chunks/index-client.ZNqWNHHH.js";import{a as X,c as ge,H as rt,q as W,u as it,b as lt}from"../chunks/scores.DHawOXJF.js";import{s as qe,c as ot}from"../chunks/settings.DiEyKd8D.js";function ct(s,t,a=t){var v=Le();Ue(s,"input",o=>{var i=o?s.defaultValue:s.value;if(i=_e(s)?me(i):i,a(i),v&&i!==(i=t())){var k=s.selectionStart,r=s.selectionEnd;s.value=i??"",r!==null&&(s.selectionStart=k,s.selectionEnd=Math.min(r,s.value.length))}}),($e&&s.defaultValue!==s.value||Ne(t)==null&&s.value)&&a(_e(s)?me(s.value):s.value),Re(()=>{var o=t();_e(s)&&o===me(s.value)||s.type==="date"&&!o&&!s.value||o!==s.value&&(s.value=o??"")})}function _e(s){var t=s.type;return t==="number"||t==="range"}function me(s){return s===""?null:+s}function fe(s,t,a){var v=Ge(s,t);v&&v.set&&(s[t]=a,Fe(()=>{s[t]=null}))}function ut(s){return function(...t){var a=t[0];return a.preventDefault(),s==null?void 0:s.apply(this,t)}}var vt=I("<div> </div>"),dt=I('<div class="quiz-item-wrapper svelte-2386oy"><div class="quiz-item svelte-2386oy"><div class="glyph svelte-2386oy"> </div> <!></div></div>');function _t(s,t){G(t,!1);const a=d(),v=d(),o=d();let i=T(t,"glyph",8),k=T(t,"answered",8,void 0),r=T(t,"is_correct_answer",8,void 0),h=T(t,"is_current",8,!1),_=T(t,"element",12,void 0);S(()=>U(k()),()=>{n(a,k()!==void 0)}),S(()=>(e(a),U(r())),()=>{n(v,e(a)?r():!1)}),S(()=>(e(a),U(r())),()=>{n(o,e(a)?!r():!1)}),he(),F();var m=dt(),f=b(m),c=b(f),p=b(c,!0);w(c);var l=A(c,2);{var y=g=>{var C=vt();const z=ae(()=>`romanisation ${(X(i())[0].length>3?"long":"")??""} svelte-2386oy`);var x=b(C,!0);V(()=>J(x,X(i())[0])),w(C),V(()=>re(C,e(z))),E(g,C)};R(l,g=>{e(o)&&g(y)})}w(f),ie(f,g=>_(g),()=>_()),w(m),V(()=>{H(f,"has-answer",e(a)),H(f,"is-correct",e(v)),H(f,"is-incorrect",e(o)),H(f,"is-current",h()),J(p,i())}),E(s,m),K()}var mt=I("<div><!></div>"),ft=I('<section class="quiz-container svelte-vgkonl"><div></div></section>');function pt(s,t){G(t,!1);let a=T(t,"items",8),v=T(t,"current_idx",8),o=d(0),i=d(),k=d(!0);async function r(){var p,l;if(await ne(),!e(i))return;const c=e(i).querySelectorAll(".quiz-content > .quiz-glyph");n(o,0);for(let y=0;y<v();y++)n(o,e(o)+(((p=c[y])==null?void 0:p.getBoundingClientRect().width)||0));n(o,e(o)+(((l=c[v()])==null?void 0:l.offsetWidth)||0)/2)}async function h(){n(k,!0),await ne(),setTimeout(()=>{n(k,!1)},2)}ye(()=>{r(),h()});function _(c){let l=Math.abs(c-v());return l=Je(Ye(Ze(l,0,8,0,1)),2)*10,l}window.addEventListener("resize",()=>{h()}),S(()=>(U(a()),U(v())),()=>{(a()||v())&&r()}),he(),F();var m=ft(),f=b(m);Xe(f,7,a,({id:c,glyph:p,answered:l,is_correct_answer:y})=>c,(c,p,l)=>{let y=()=>e(p).glyph,g=()=>e(p).answered,C=()=>e(p).is_correct_answer;var z=mt();const x=ae(()=>`filter: blur(calc(${_(e(l))??""}px))`);var q=b(z),B=ae(()=>e(l)==v());_t(q,{get glyph(){return y()},get answered(){return g()},get is_correct_answer(){return C()},get is_current(){return e(B)}}),w(z),V(()=>{re(z,`quiz-glyph ${(e(l)===v()?"current":"")??""} svelte-vgkonl`),pe(z,"style",e(x))}),E(c,z)}),w(f),w(m),ie(m,c=>n(i,c),()=>e(i)),V(()=>{re(f,`quiz-content ${(e(k)?"no-transition":"")??""} svelte-vgkonl`),pe(f,"style",`transform: translateX(calc(50vw - ${e(o)??""}px));`)}),E(s,m),K()}var gt=I('<form class="answer-input content-width svelte-i9oslv"><input type="text" class="text-field svelte-i9oslv" placeholder="type here..." autocapitalize="none" autocomplete="off" autocorrect="off"></form>');function ht(s,t){G(t,!1);const a=ze(),v=()=>$(qe,"$settings",a);let o=T(t,"onSubmit",8),i=T(t,"input",12,""),k=T(t,"current_glyph",8),r=T(t,"input_element",12);const h=/^\s+$/;let _=d(!1);function m(){ge(i(),k())||n(_,!0),o()(i()),i("")}function f(y){const g=["insertCompositionText","deleteCompositionText"];return y.isComposing||g.includes(y.inputType)}function c(y){const g=y;if(!f(g)&&k()!==null&&g.data!==null){if(i(i().trim()),h.test(g.data)){m();return}ge(i(),k())&&v().auto_submit&&m()}}F();var p=gt(),l=b(p);et(l),pe(l,"spellcheck",!1),ie(l,y=>r(y),()=>r()),w(p),V(()=>H(p,"shake-animation-playing",e(_))),ct(l,i),N("input",l,c),N("submit",p,ut(m)),N("animationend",p,()=>n(_,!1)),E(s,p),K()}var yt=I('<span class="tilt-animation-container svelte-pgyicl"><span class="material-symbols-rounded reset-animation-container menu-icon flipped svelte-pgyicl">refresh</span></span>'),wt=I('<span class="material-symbols-rounded menu-icon svelte-pgyicl">help</span>'),bt=I('<section class="menu svelte-pgyicl"><div class="button-container svelte-pgyicl"><a href="setup" class="button svelte-pgyicl" title="Go back"><span class="material-symbols-rounded menu-icon svelte-pgyicl">arrow_back</span></a></div> <div class="button-container svelte-pgyicl"><button type="button" class="button svelte-pgyicl" title="Toggle auto-submit"><span class="material-symbols-rounded reset-animation-container menu-icon svelte-pgyicl">keyboard_double_arrow_up</span></button></div> <div class="button-container tilt svelte-pgyicl"><!></div> <div class="button-container svelte-pgyicl"><!></div></section>');function kt(s,t){G(t,!1);let a=d(!1),v=T(t,"menu_event",8),o=T(t,"is_keyboard_open",8),i=T(t,"auto_submit",8),k=T(t,"show_help",12);F();var r=bt(),h=A(b(r),2),_=b(h);w(h);var m=A(h,2),f=b(m);xe(f,{style:"menu-icon",title:"Restart game",$$events:{click:()=>{v()("restart"),n(a,!0)}},children:(l,y)=>{var g=yt(),C=b(g);w(g),N("animationend",C,()=>{n(a,!1)}),E(l,g)},$$slots:{default:!0}}),w(m);var c=A(m,2),p=b(c);xe(p,{style:"menu-icon",title:"Help",$$events:{click:()=>k(!k())},children:(l,y)=>{var g=wt();E(l,g)},$$slots:{default:!0}}),w(c),w(r),V(()=>{H(r,"keyboard-open",o()),H(h,"activated",i()),H(m,"reset-animation-playing",e(a))}),N("click",_,()=>{v()("toggle-auto-submit")}),E(s,r),K()}var xt=I('<span class="best-time not-set svelte-13j0w94">best: --:--.-s</span>'),Tt=I('<span class="best-time svelte-13j0w94">best: <span class="nowrap svelte-13j0w94"> </span></span>'),zt=I('<div class="stopwatch svelte-13j0w94"><span><!>s</span> <!></div>');function qt(s,t){G(t,!1);let a=T(t,"elapsed_time",12,0),v=T(t,"is_paused",12,!0),o=T(t,"is_disabled",8,!1),i=T(t,"best_time",24,()=>-1),k=T(t,"time_style",8,"normal"),r=null;ye(()=>()=>{_()});function h(){v(!1),r||(r=setInterval(()=>{a(a()+.1),a(tt(a(),2))},100))}function _(){v(!0),r&&(clearInterval(r),r=null)}function m(){_(),a(0)}F();var f=zt(),c=b(f),p=b(c);{var l=x=>{var q=be("--:--.-");E(x,q)},y=x=>{var q=be();V(()=>J(q,Te(a()))),E(x,q)};R(p,x=>{o()?x(l):x(y,!1)})}Ke(),w(c);var g=A(c,2);{var C=x=>{var q=xt();E(x,q)},z=x=>{var q=Tt(),B=A(b(q)),Y=b(B);V(()=>J(Y,`${Te(i())??""}s`)),w(B),w(q),E(x,q)};R(g,x=>{i()<0?x(C):x(z,!1)})}return w(f),V(()=>re(c,`time ${k()??""} nowrap svelte-13j0w94`)),E(s,f),fe(t,"startTimer",h),fe(t,"stopTimer",_),fe(t,"resetTimer",m),K({startTimer:h,stopTimer:_,resetTimer:m})}var St=I("<!> <!> <!>",1),Et=I('<div><div class="contents svelte-lqm45p"><div class="top-bar svelte-lqm45p"><div><a href="/">glyph-glyph</a> <span class="config-id svelte-lqm45p"> </span></div> <!></div> <div class="play-contents svelte-lqm45p"><!></div></div> <!></div>');function $t(s,t){G(t,!1);const a=ze(),v=()=>$(W,"$quiz",a),o=()=>$(at,"$game_config",a),i=()=>$(lt,"$high_scores",a),k=()=>$(qe,"$settings",a),r=()=>$(nt,"$dictionary",a),h=d(),_=d(),m=d(),f=d(),c=d(),p=d(),l=d(),y=d(),g=d();let C=d(!0),z=d(!1),x=d(!1);function q(){window.visualViewport&&n(x,window.visualViewport.height<window.innerHeight)}ye(()=>{window.visualViewport&&(window.visualViewport.addEventListener("resize",q),q());const u=W.subscribe(()=>{n(C,!1)});return n(z,e(_)>0),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",q),u()}});const B=/^[a-z0-9]+$/i;let Y=d(),Z=d(),O=d(),le=d(0),D=d(),ee=d(!1),te=d(!1);function Se(u){var M;switch(u){case"restart":o().path.includes("hangul")&&o().path.includes("syllables")&&st(),W.reset(),e(l)&&((M=e(O))==null||M.resetTimer(),n(z,!1),n(ee,!1));break;case"toggle-auto-submit":ot()}}async function Ee(u){if(!o().is_valid||!e(m))return;e(l)&&e(D)&&e(O).startTimer();const M=ge(u,e(m).glyph);!M&&u===""||(W.updateItem(e(_),L=>({...L,answered:u,is_correct_answer:M})),W.updateIndex(We(_)),await ne(),!e(z)&&e(_)==e(h).length&&e(l)&&!e(D)&&(e(O).stopTimer(),e(f)&&n(ee,it(e(c),e(le)))),await ne())}function Ce(u){u.isComposing||document.activeElement!==e(Z)&&u.key!==" "&&u.key.length===1&&B.test(u.key)&&e(Z).focus()}S(()=>v(),()=>{n(h,v().items)}),S(()=>v(),()=>{n(_,v().current_idx)}),S(()=>(e(h),e(_)),()=>{n(m,e(h)&&e(h)[e(_)])}),S(()=>(e(h),e(_)),()=>{n(f,e(h).slice(0,e(_)).every(u=>u==null?void 0:u.is_correct_answer))}),S(()=>o(),()=>{n(c,o().id)}),S(()=>(i(),e(c)),()=>{n(p,i()[e(c)])}),S(()=>k(),()=>{n(l,k().using_stopwatch)}),S(()=>(e(z),e(ee),e(f),e(D)),()=>{n(y,e(z)?"inactive":e(ee)?"record-set":e(f)?e(D)?"inactive":"normal":"incorrect")}),S(()=>r(),()=>{console.log(r()[0])}),S(()=>r(),()=>{console.log(X(r()[0])[0])}),S(()=>r(),()=>{console.log(r())}),S(()=>(r(),X),()=>{n(g,`Type the correct answer for the current (underlined) glyph in the
   queue.

For example for `+r()[0]+', type "'+X(r()[0])[0]+`" 

There are buttons for restarting and for toggling the auto-submit mechanism 
   (automatically submits a correct answer)`)}),he(),F();var oe=Et();Be(u=>{Oe.title="Play Â· glyph-glyph"}),N("keydown",Qe,Ce);var ce=b(oe),ue=b(ce),ve=b(ue),we=A(b(ve),2),Ie=b(we,!0);w(we),w(ve);var Ae=A(ve,2);{var Me=u=>{var M=De(),L=ke(M);{var se=Q=>{ie(qt(Q,{get is_disabled(){return e(z)},get best_time(){return e(p)},get time_style(){return e(y)},get elapsed_time(){return e(le)},set elapsed_time(j){n(le,j)},get is_paused(){return e(D)},set is_paused(j){n(D,j)},$$legacy:!0}),j=>n(O,j),()=>e(O))};R(L,Q=>{e(l)&&Q(se)})}E(u,M)};R(Ae,u=>{e(C)||u(Me)})}w(ue);var de=A(ue,2),Ve=b(de);{var He=u=>{},Pe=u=>{var M=St(),L=ke(M);pt(L,{get items(){return e(h)},get current_idx(){return e(_)}});var se=A(L,2),Q=ae(()=>{var P;return(P=e(m))==null?void 0:P.glyph});ht(se,{onSubmit:Ee,get current_glyph(){return e(Q)},get input(){return e(Y)},set input(P){n(Y,P)},get input_element(){return e(Z)},set input_element(P){n(Z,P)},$$legacy:!0});var j=A(se,2);kt(j,{menu_event:Se,get is_keyboard_open(){return e(x)},get auto_submit(){return k().auto_submit},get show_help(){return e(te)},set show_help(P){n(te,P)},$$legacy:!0}),E(u,M)};R(Ve,u=>{e(C)?u(He):u(Pe,!1)})}w(de),w(ce);var je=A(ce,2);rt(je,{get instructions(){return e(g)},get is_open(){return e(te)},set is_open(u){n(te,u)},$$legacy:!0}),w(oe),V(()=>{J(Ie,o().id),H(de,"keyboard-open",e(x))}),E(s,oe),K()}export{$t as component};
