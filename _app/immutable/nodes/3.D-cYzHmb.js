import{a as q,t as M,d as ge,h as Ce,c as Ae}from"../chunks/disclose-version.B8nYLgL4.js";import{i as N}from"../chunks/legacy.CgpFKzs7.js";import{aM as Me,h as Ve,u as je,b as He,a4 as Le,z as Pe,p as O,a9 as I,aa as _e,c as h,r as p,s as j,A as e,t as A,a as Q,aw as _,a7 as X,y as l,M as $,au as ue,ay as Be,ax as De,aN as Re,f as he,aO as Ge}from"../chunks/utils.BlbffUCT.js";import{l as Ke,s as F,e as G}from"../chunks/render.C1RE0XEP.js";import{i as K,s as Ne,a as Z}from"../chunks/store.CbB5JJSv.js";import{j as ee,l as H,n as Oe,k as ve,w as Qe,x as We,y as Ue,z as Xe,v as we,A as Fe,B as Je,d as Ye}from"../chunks/dictionary.BY6BbDGO.js";import{b as te}from"../chunks/this.-2yZ0d7J.js";import{p as b}from"../chunks/props.BQz8PEny.js";import{o as fe}from"../chunks/index-client.DXjkudc0.js";import{a as ye,b as de,q as U,u as Ze,h as $e}from"../chunks/scores.p8Rtmzwn.js";import{s as et}from"../chunks/settings.BbKrtD84.js";function tt(t,a,s=a){var n=Me();Ke(t,"input",r=>{var o=r?t.defaultValue:t.value;if(o=le(t)?oe(o):o,s(o),n&&o!==(o=a())){var g=t.selectionStart,i=t.selectionEnd;t.value=o??"",i!==null&&(t.selectionStart=g,t.selectionEnd=Math.min(i,t.value.length))}}),(Ve&&t.defaultValue!==t.value||je(a)==null&&t.value)&&s(le(t)?oe(t.value):t.value),He(()=>{var r=a();le(t)&&r===oe(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function le(t){var a=t.type;return a==="number"||a==="range"}function oe(t){return t===""?null:+t}function ce(t,a,s){var n=Pe(t,a);n&&n.set&&(t[a]=s,Le(()=>{t[a]=null}))}function at(t){return function(...a){var s=a[0];return s.preventDefault(),t==null?void 0:t.apply(this,a)}}var st=M("<div> </div>"),nt=M('<div class="quiz-item-wrapper svelte-2386oy"><div class="quiz-item svelte-2386oy"><div class="glyph svelte-2386oy"> </div> <!></div></div>');function rt(t,a){O(a,!1);const s=_(),n=_(),r=_();let o=b(a,"glyph",8),g=b(a,"answered",8,void 0),i=b(a,"is_correct_answer",8,void 0),f=b(a,"is_current",8,!1),x=b(a,"element",12,void 0);I(()=>X(g()),()=>{l(s,g()!==void 0)}),I(()=>(e(s),X(i())),()=>{l(n,e(s)?i():!1)}),I(()=>(e(s),X(i())),()=>{l(r,e(s)?!i():!1)}),_e(),N();var y=nt(),c=h(y),u=h(c),d=h(u,!0);p(u);var m=j(u,2);{var T=z=>{var E=st();const S=$(()=>`romanisation ${(ye(o())[0].length>3?"long":"")??""} svelte-2386oy`);var w=h(E,!0);A(()=>F(w,ye(o())[0])),p(E),A(()=>ee(E,e(S))),q(z,E)};K(m,z=>{e(r)&&z(T)})}p(c),te(c,z=>x(z),()=>x()),p(y),A(()=>{H(c,"has-answer",e(s)),H(c,"is-correct",e(n)),H(c,"is-incorrect",e(r)),H(c,"is-current",f()),F(d,o())}),q(t,y),Q()}var it=M("<div><!></div>"),lt=M('<section class="quiz-container svelte-11xyc1x"><div></div></section>');function ot(t,a){O(a,!1);let s=b(a,"items",8),n=b(a,"current_idx",8),r=_(0),o=_(),g=_(!0);async function i(){var d,m;if(await ue(),!e(o))return;const u=e(o).querySelectorAll(".quiz-content > .quiz-glyph");l(r,0);for(let T=0;T<n();T++)l(r,e(r)+(((d=u[T])==null?void 0:d.getBoundingClientRect().width)||0));l(r,e(r)+(((m=u[n()])==null?void 0:m.offsetWidth)||0)/2)}async function f(){l(g,!0),await ue(),setTimeout(()=>{l(g,!1)},2)}fe(()=>{i(),f()});function x(u){let m=Math.abs(u-n());return m=Qe(We(Ue(m,0,8,0,1)),2)*10,m}window.addEventListener("resize",()=>{f()}),I(()=>(X(s()),X(n())),()=>{(s()||n())&&i()}),_e(),N();var y=lt(),c=h(y);Oe(c,7,s,({id:u,glyph:d,answered:m,is_correct_answer:T})=>u,(u,d,m)=>{let T=()=>e(d).glyph,z=()=>e(d).answered,E=()=>e(d).is_correct_answer;var S=it();const w=$(()=>`filter: blur(calc(${x(e(m))??""}px))`);var k=h(S),V=$(()=>e(m)==n());rt(k,{get glyph(){return T()},get answered(){return z()},get is_correct_answer(){return E()},get is_current(){return e(V)}}),p(S),A(()=>{ee(S,`quiz-glyph ${(e(m)===n()?"current":"")??""} svelte-11xyc1x`),ve(S,"style",e(w))}),q(u,S)}),p(c),p(y),te(y,u=>l(o,u),()=>e(o)),A(()=>{ee(c,`quiz-content ${(e(g)?"no-transition":"")??""} svelte-11xyc1x`),ve(c,"style",`transform: translateX(calc(50vw - ${e(r)??""}px));`)}),q(t,y),Q()}var ct=M('<form class="answer-input content-width svelte-i9oslv"><input type="text" class="text-field svelte-i9oslv" placeholder="type here..." autocapitalize="none" autocomplete="off" autocorrect="off"></form>');function ut(t,a){O(a,!1);let s=b(a,"onSubmit",8),n=b(a,"input",12,""),r=b(a,"current_glyph",8),o=b(a,"input_element",12);const g=/^\s+$/;let i=_(!1);function f(){de(n(),r())||l(i,!0),s()(n()),n("")}function x(d){const m=["insertCompositionText","deleteCompositionText"];return d.isComposing||m.includes(d.inputType)}function y(d){const m=d;if(!x(m)&&r()!==null&&m.data!==null){if(n(n().trim()),g.test(m.data)){f();return}de(n(),r())&&f()}}N();var c=ct(),u=h(c);Xe(u),ve(u,"spellcheck",!1),te(u,d=>o(d),()=>o()),p(c),A(()=>H(c,"shake-animation-playing",e(i))),tt(u,n),G("input",u,y),G("submit",c,at(f)),G("animationend",c,()=>l(i,!1)),q(t,c),Q()}var vt=M('<section class="menu svelte-vpz0se"><a href="setup" class="button svelte-vpz0se" title="Go back"><span class="material-symbols-rounded menu-icon svelte-vpz0se">arrow_back</span></a> <button type="button" class="button tilt svelte-vpz0se" title="Restart game"><span class="tilt-animation-container svelte-vpz0se"><span class="material-symbols-rounded reset-animation-container menu-icon svelte-vpz0se">refresh</span></span></button></section>');function dt(t,a){O(a,!1);let s=_(!1),n=b(a,"menu_event",8),r=b(a,"is_keyboard_open",8);N();var o=vt(),g=j(h(o),2),i=h(g),f=h(i);p(i),p(g),p(o),A(()=>{H(o,"keyboard-open",r()),H(g,"reset-animation-playing",e(s))}),G("animationend",f,()=>{l(s,!1)}),G("click",g,()=>{n()("restart"),l(s,!0)}),q(t,o),Q()}var _t=M('<span class="best-time not-set svelte-13j0w94">best: --:--.-s</span>'),ft=M('<span class="best-time svelte-13j0w94">best: <span class="nowrap svelte-13j0w94"> </span></span>'),mt=M('<div class="stopwatch svelte-13j0w94"><span><!>s</span> <!></div>');function pt(t,a){O(a,!1);let s=b(a,"elapsed_time",12,0),n=b(a,"is_paused",12,!0),r=b(a,"is_disabled",8,!1),o=b(a,"best_time",24,()=>-1),g=b(a,"time_style",8,"normal"),i=null;fe(()=>()=>{x()});function f(){n(!1),i||(i=setInterval(()=>{s(s()+.1),s(Fe(s(),2))},100))}function x(){n(!0),i&&(clearInterval(i),i=null)}function y(){x(),s(0)}N();var c=mt(),u=h(c),d=h(u);{var m=w=>{var k=ge("--:--.-");q(w,k)},T=w=>{var k=ge();A(()=>F(k,we(s()))),q(w,k)};K(d,w=>{r()?w(m):w(T,!1)})}Be(),p(u);var z=j(u,2);{var E=w=>{var k=_t();q(w,k)},S=w=>{var k=ft(),V=j(h(k)),L=h(V);A(()=>F(L,`${we(o())??""}s`)),p(V),p(k),q(w,k)};K(z,w=>{o()<0?w(E):w(S,!1)})}return p(c),A(()=>ee(u,`time ${g()??""} nowrap svelte-13j0w94`)),q(t,c),ce(a,"startTimer",f),ce(a,"stopTimer",x),ce(a,"resetTimer",y),Q({startTimer:f,stopTimer:x,resetTimer:y})}var gt=M("<!> <!> <!>",1),ht=M('<div><div class="contents svelte-ebb7wt"><div class="top-bar svelte-ebb7wt"><div><a href="/">glyph-glyph</a> <span class="config-id svelte-ebb7wt"> </span></div> <!></div> <div class="play-contents svelte-ebb7wt"><!></div></div></div>');function Ct(t,a){O(a,!1);const s=Ne(),n=()=>Z(U,"$quiz",s),r=()=>Z(Ye,"$game_config",s),o=()=>Z($e,"$high_scores",s),g=()=>Z(et,"$settings",s),i=_(),f=_(),x=_(),y=_(),c=_(),u=_(),d=_(),m=_();let T=_(!0),z=_(!1),E=_(!1);function S(){window.visualViewport&&l(E,window.visualViewport.height<window.innerHeight)}fe(()=>{window.visualViewport&&(window.visualViewport.addEventListener("resize",S),S());const v=U.subscribe(()=>{l(T,!1)});return l(z,e(f)>0),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",S),v()}});const w=/^[a-z0-9]+$/i;let k=_(),V=_(),L=_(),ae=_(0),B=_(),J=_(!1);function be(v){var C;switch(v){case"restart":r().path.includes("hangul")&&r().path.includes("syllables")&&Je(),U.reset(),e(d)&&((C=e(L))==null||C.resetTimer(),l(z,!1),l(J,!1));break}}async function xe(v){if(!r().is_valid||!e(x))return;e(d)&&e(B)&&e(L).startTimer();const C=de(v,e(x).glyph);!C&&v===""||(U.updateItem(e(f),D=>({...D,answered:v,is_correct_answer:C})),U.updateIndex(Ge(f)),!e(z)&&e(f)==e(i).length&&e(d)&&!e(B)&&(e(L).stopTimer(),e(y)&&l(J,Ze(e(c),e(ae)))),await ue())}function ze(v){v.isComposing||document.activeElement!==e(V)&&v.key!==" "&&v.key.length===1&&w.test(v.key)&&e(V).focus()}I(()=>n(),()=>{l(i,n().items)}),I(()=>n(),()=>{l(f,n().current_idx)}),I(()=>(e(i),e(f)),()=>{l(x,e(i)&&e(i)[e(f)])}),I(()=>(e(i),e(f)),()=>{l(y,e(i).slice(0,e(f)).every(v=>v==null?void 0:v.is_correct_answer))}),I(()=>r(),()=>{l(c,r().id)}),I(()=>(o(),e(c)),()=>{l(u,o()[e(c)])}),I(()=>g(),()=>{l(d,g().using_stopwatch)}),I(()=>(e(z),e(J),e(y),e(B)),()=>{l(m,e(z)?"inactive":e(J)?"record-set":e(y)?e(B)?"inactive":"normal":"incorrect")}),_e(),N();var se=ht();Ce(v=>{De.title="Play Â· glyph-glyph"}),G("keydown",Re,ze);var me=h(se),ne=h(me),re=h(ne),pe=j(h(re),2),ke=h(pe,!0);p(pe),p(re);var Te=j(re,2);{var qe=v=>{var C=Ae(),D=he(C);{var Y=W=>{te(pt(W,{get is_disabled(){return e(z)},get best_time(){return e(u)},get time_style(){return e(m)},get elapsed_time(){return e(ae)},set elapsed_time(P){l(ae,P)},get is_paused(){return e(B)},set is_paused(P){l(B,P)},$$legacy:!0}),P=>l(L,P),()=>e(L))};K(D,W=>{e(d)&&W(Y)})}q(v,C)};K(Te,v=>{e(T)||v(qe)})}p(ne);var ie=j(ne,2),Se=h(ie);{var Ee=v=>{},Ie=v=>{var C=gt(),D=he(C);ot(D,{get items(){return e(i)},get current_idx(){return e(f)}});var Y=j(D,2),W=$(()=>{var R;return(R=e(x))==null?void 0:R.glyph});ut(Y,{onSubmit:xe,get current_glyph(){return e(W)},get input(){return e(k)},set input(R){l(k,R)},get input_element(){return e(V)},set input_element(R){l(V,R)},$$legacy:!0});var P=j(Y,2);dt(P,{menu_event:be,get is_keyboard_open(){return e(E)}}),q(v,C)};K(Se,v=>{e(T)?v(Ee):v(Ie,!1)})}p(ie),p(me),p(se),A(()=>{F(ke,r().id),H(ie,"keyboard-open",e(E))}),q(t,se),Q()}export{Ct as component};
