import{a as k,t as E,b as _e,h as qe,c as ze}from"../chunks/disclose-version.BnyP3OB8.js";import{i as O}from"../chunks/legacy.Vqdj_PMR.js";import{aM as ke,h as Ie,u as Se,b as Ce,a7 as Ee,C as Me,p as V,ac as S,ad as ce,c as q,r as w,s as D,D as e,t as A,a as W,aB as f,aa as U,B as l,Q as Y,az as ie,ae as Ae,af as je,aN as Be,f as de,aO as De}from"../chunks/utils.Dhw7Y63s.js";import{l as Pe,s as Z,e as L}from"../chunks/render.DlAr8I1h.js";import{i as N,s as He,a as J}from"../chunks/store.BWdm8UL4.js";import{b as ee}from"../chunks/this.CHCpDkWg.js";import{b as fe,e as Qe,j as Re,k as Le,m as Ne,l as le,f as me,r as Oe,q as K,n as Ve,g as We,h as Ge}from"../chunks/scores.BJ7-JvPj.js";import{s as $,t as R,a as oe,r as Ke}from"../chunks/class.7PBngDXZ.js";import{p as b}from"../chunks/props.edKkFTeU.js";import{o as ue}from"../chunks/index-client.BhUYpw5D.js";import{s as Ue}from"../chunks/settings._mfimNkJ.js";function Xe(t,a,s=a){var r=ke();Pe(t,"input",n=>{var o=n?t.defaultValue:t.value;if(o=se(t)?re(o):o,s(o),r&&o!==(o=a())){var h=t.selectionStart,i=t.selectionEnd;t.value=o??"",i!==null&&(t.selectionStart=h,t.selectionEnd=Math.min(i,t.value.length))}}),(Ie&&t.defaultValue!==t.value||Se(a)==null&&t.value)&&s(se(t)?re(t.value):t.value),Ce(()=>{var n=a();se(t)&&n===re(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function se(t){var a=t.type;return a==="number"||a==="range"}function re(t){return t===""?null:+t}function ne(t,a,s){var r=Me(t,a);r&&r.set&&(t[a]=s,Ee(()=>{t[a]=null}))}function Fe(t){return function(...a){var s=a[0];return s.preventDefault(),t==null?void 0:t.apply(this,a)}}var Je=E("<div> </div>"),Ye=E('<div class="quiz-item-wrapper svelte-14tw409"><div class="quiz-item svelte-14tw409"><div class="glyph svelte-14tw409"> </div> <!></div></div>');function Ze(t,a){V(a,!1);const s=f(),r=f(),n=f();let o=b(a,"glyph",8),h=b(a,"answered",8,void 0),i=b(a,"is_correct_answer",8,void 0),m=b(a,"is_current",8,!1),x=b(a,"element",12,void 0);S(()=>U(h()),()=>{l(s,h()!==void 0)}),S(()=>(e(s),U(i())),()=>{l(r,e(s)?i():!1)}),S(()=>(e(s),U(i())),()=>{l(n,e(s)?!i():!1)}),ce(),O();var g=Ye(),c=q(g),u=q(c),_=q(u,!0);w(u);var d=D(u,2);{var z=T=>{var M=Je();const I=Y(()=>`romanisation ${(fe(o())[0].length>3?"long":"")??""} svelte-14tw409`);var p=q(M,!0);A(()=>Z(p,fe(o())[0])),w(M),A(()=>$(M,e(I))),k(T,M)};N(d,T=>{e(n)&&T(z)})}w(c),ee(c,T=>x(T),()=>x()),w(g),A(()=>{R(c,"has-answer",e(s)),R(c,"is-correct",e(r)),R(c,"is-incorrect",e(n)),R(c,"is-current",m()),Z(_,o())}),k(t,g),W()}var $e=E("<div><!></div>"),et=E('<section class="quiz-container svelte-1tcd3jh"><div></div></section>');function tt(t,a){V(a,!1);let s=b(a,"items",8),r=b(a,"current_idx",8),n=f(0),o=f(),h=f(!0);async function i(){var _,d;if(await ie(),!e(o))return;const u=e(o).querySelectorAll(".quiz-content > .quiz-glyph");l(n,0);for(let z=0;z<r();z++)l(n,e(n)+(((_=u[z])==null?void 0:_.getBoundingClientRect().width)||0));l(n,e(n)+(((d=u[r()])==null?void 0:d.offsetWidth)||0)/2)}async function m(){l(h,!0),await ie(),setTimeout(()=>{l(h,!1)},2)}ue(()=>{i(),m()});function x(u){let d=Math.abs(u-r());return d=Re(Le(Ne(d,0,8,0,1)),2)*10,d}window.addEventListener("resize",()=>{m()}),S(()=>(U(s()),U(r())),()=>{(s()||r())&&i()}),ce(),O();var g=et(),c=q(g);Qe(c,7,s,({id:u,glyph:_,answered:d,is_correct_answer:z})=>u,(u,_,d)=>{let z=()=>e(_).glyph,T=()=>e(_).answered,M=()=>e(_).is_correct_answer;var I=$e();const p=Y(()=>`filter: blur(calc(${x(e(d))??""}px))`);var y=q(I),j=Y(()=>e(d)==r());Ze(y,{get glyph(){return z()},get answered(){return T()},get is_correct_answer(){return M()},get is_current(){return e(j)}}),w(I),A(()=>{$(I,`quiz-glyph ${(e(d)===r()?"current":"")??""} svelte-1tcd3jh`),oe(I,"style",e(p))}),k(u,I)}),w(c),w(g),ee(g,u=>l(o,u),()=>e(o)),A(()=>{$(c,`quiz-content ${(e(h)?"no-transition":"")??""} svelte-1tcd3jh`),oe(c,"style",`transform: translateX(calc(50vw - ${e(n)??""}px));`)}),k(t,g),W()}var at=E('<form class="answer-input content-width svelte-1veo0yu"><input type="text" class="text-field svelte-1veo0yu" placeholder="type here..." autocapitalize="none" autocomplete="off" autocorrect="off"></form>');function st(t,a){V(a,!1);let s=b(a,"onSubmit",8),r=b(a,"input",12,""),n=b(a,"current_glyph",8),o=b(a,"input_element",12);const h=/^\s+$/;let i=f(!1);function m(){le(r(),n())||l(i,!0),s()(r()),r("")}function x(_){const d=["insertCompositionText","deleteCompositionText"];return _.isComposing||d.includes(_.inputType)}function g(_){const d=_;if(!x(d)&&n()!==null&&d.data!==null){if(r(r().trim()),h.test(d.data)){m();return}le(r(),n())&&m()}}O();var c=at(),u=q(c);Ke(u),oe(u,"spellcheck",!1),ee(u,_=>o(_),()=>o()),w(c),A(()=>R(c,"shake-animation-playing",e(i))),Xe(u,r),L("input",u,g),L("submit",c,Fe(m)),L("animationend",c,()=>l(i,!1)),k(t,c),W()}var rt=E('<section class="menu svelte-1m9ut8b"><a href="setup" class="button svelte-1m9ut8b" title="Go back"><span class="material-symbols-rounded menu-icon svelte-1m9ut8b">arrow_back</span></a> <button type="button" class="button tilt svelte-1m9ut8b" title="Restart game"><span class="tilt-animation-container svelte-1m9ut8b"><span class="material-symbols-rounded reset-animation-container menu-icon svelte-1m9ut8b">refresh</span></span></button></section>');function nt(t,a){V(a,!1);let s=f(!1),r=b(a,"menu_event",8);O();var n=rt(),o=D(q(n),2),h=q(o),i=q(h);w(h),w(o),w(n),A(()=>R(o,"reset-animation-playing",e(s))),L("animationend",i,()=>{l(s,!1)}),L("click",o,()=>{r()("restart"),l(s,!0)}),k(t,n),W()}var it=E('<span class="best-time not-set svelte-13swphy">no record set</span>'),lt=E('<span class="best-time svelte-13swphy"> </span>'),ot=E('<div class="stopwatch svelte-13swphy"><span><!>s</span> <!></div>');function ct(t,a){V(a,!1);let s=b(a,"elapsed_time",12,0),r=b(a,"is_paused",12,!0),n=b(a,"is_disabled",8,!1),o=b(a,"best_time",24,()=>-1),h=b(a,"time_style",8,"normal"),i=null;ue(()=>()=>{x()});function m(){r(!1),i||(i=setInterval(()=>{s(s()+.1),s(Oe(s(),2))},100))}function x(){r(!0),i&&(clearInterval(i),i=null)}function g(){x(),s(0)}O();var c=ot(),u=q(c),_=q(u);{var d=p=>{var y=_e("--:--.-");k(p,y)},z=p=>{var y=_e();A(()=>Z(y,me(s()))),k(p,y)};N(_,p=>{n()?p(d):p(z,!1)})}Ae(),w(u);var T=D(u,2);{var M=p=>{var y=it();k(p,y)},I=p=>{var y=lt(),j=q(y);A(()=>Z(j,`best time: ${me(o())??""}s`)),w(y),k(p,y)};N(T,p=>{o()<0?p(M):p(I,!1)})}return w(c),A(()=>$(u,`time ${h()??""} svelte-13swphy`)),k(t,c),ne(a,"startTimer",m),ne(a,"stopTimer",x),ne(a,"resetTimer",g),W({startTimer:m,stopTimer:x,resetTimer:g})}var ut=E("<!> <!> <!>",1),vt=E('<div><div class="top-bar svelte-1qn4cv"><a href="/" class="title svelte-1qn4cv">glyph-glyph</a> <!></div> <div class="contents svelte-1qn4cv"><!></div></div>');function Tt(t,a){V(a,!1);const s=He(),r=()=>J(K,"$quiz",s),n=()=>J(We,"$game_config",s),o=()=>J(Ge,"$high_scores",s),h=()=>J(Ue,"$settings",s),i=f(),m=f(),x=f(),g=f(),c=f(),u=f(),_=f(),d=f();let z=f(!0),T=f(!1);ue(()=>{const v=K.subscribe(()=>{l(z,!1)});return l(T,e(m)>0),()=>v()});const M=/^[a-z0-9]+$/i;let I=f(),p=f(),y=f(),j=f(0),P=f(),X=f(!1);function pe(v){var C;switch(v){case"restart":K.reset(),e(_)&&((C=e(y))==null||C.resetTimer(),l(T,!1),l(X,!1));break}}async function he(v){if(!n().is_valid||!e(x))return;e(_)&&e(P)&&e(y).startTimer();const C=le(v,e(x).glyph);!C&&v===""||(K.updateItem(e(m),H=>({...H,answered:v,is_correct_answer:C})),K.updateIndex(De(m)),!e(T)&&e(m)==e(i).length&&e(_)&&!e(P)&&(e(y).stopTimer(),e(g)&&(Ve(e(c),e(j)),l(X,!0))),await ie())}function ge(v){v.isComposing||document.activeElement!==e(p)&&v.key!==" "&&v.key.length===1&&M.test(v.key)&&e(p).focus()}S(()=>r(),()=>{l(i,r().items)}),S(()=>r(),()=>{l(m,r().current_idx)}),S(()=>(e(i),e(m)),()=>{l(x,e(i)&&e(i)[e(m)])}),S(()=>(e(i),e(m)),()=>{l(g,e(i).slice(0,e(m)).every(v=>v==null?void 0:v.is_correct_answer))}),S(()=>n(),()=>{l(c,n().id)}),S(()=>(o(),e(c)),()=>{l(u,o()[e(c)])}),S(()=>h(),()=>{l(_,h().using_stopwatch)}),S(()=>(e(T),e(X),e(g),e(P)),()=>{l(d,e(T)?"inactive":e(X)?"record-set":e(g)?e(P)?"inactive":"normal":"incorrect")}),ce(),O();var te=vt();qe(v=>{je.title="Play Â· glyph-glyph"}),L("keydown",Be,ge);var ae=q(te),ye=D(q(ae),2);{var be=v=>{var C=ze(),H=de(C);{var F=G=>{ee(ct(G,{get is_disabled(){return e(T)},get best_time(){return e(u)},get time_style(){return e(d)},get elapsed_time(){return e(j)},set elapsed_time(B){l(j,B)},get is_paused(){return e(P)},set is_paused(B){l(P,B)},$$legacy:!0}),B=>l(y,B),()=>e(y))};N(H,G=>{e(_)&&G(F)})}k(v,C)};N(ye,v=>{e(z)||v(be)})}w(ae);var ve=D(ae,2),we=q(ve);{var xe=v=>{},Te=v=>{var C=ut(),H=de(C);tt(H,{get items(){return e(i)},get current_idx(){return e(m)}});var F=D(H,2),G=Y(()=>{var Q;return(Q=e(x))==null?void 0:Q.glyph});st(F,{onSubmit:he,get current_glyph(){return e(G)},get input(){return e(I)},set input(Q){l(I,Q)},get input_element(){return e(p)},set input_element(Q){l(p,Q)},$$legacy:!0});var B=D(F,2);nt(B,{menu_event:pe}),k(v,C)};N(we,v=>{e(z)?v(xe):v(Te,!1)})}w(ve),w(te),k(t,te),W()}export{Tt as component};
